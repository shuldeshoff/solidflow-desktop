# План создания каркаса проекта

Детальный план по инициализации и созданию базовой структуры проекта SolidFlow Desktop.

## Этап 1: Базовая настройка окружения

### 1.1 Создание структуры директорий
```
solidflow-desktop/
├── src/
│   ├── solidflow/
│   │   ├── __init__.py
│   │   ├── core/
│   │   ├── gui/
│   │   ├── geometry/
│   │   ├── analysis/
│   │   ├── ml/
│   │   ├── cam/
│   │   ├── plugins/
│   │   └── utils/
│   └── __init__.py
├── tests/
│   ├── __init__.py
│   ├── unit/
│   ├── integration/
│   └── fixtures/
├── docs/
├── resources/
│   ├── icons/
│   ├── models/
│   └── shaders/
├── scripts/
└── build/
```

### 1.2 Создание файлов конфигурации
* `.gitignore` - исключения для Git
* `requirements.txt` - зависимости Python
* `requirements-dev.txt` - зависимости для разработки
* `setup.py` или `pyproject.toml` - конфигурация пакета
* `README.md` - основной README проекта (в корне)
* `.env.example` - пример файла с переменными окружения
* `pyproject.toml` - конфигурация для black, flake8, mypy (если используется)

### 1.3 Настройка виртуального окружения
* Создание venv
* Установка базовых зависимостей
* Документация по активации окружения

## Этап 2: Базовая структура кода

### 2.1 Ядро системы (core/)
* `__init__.py`
* `application.py` - главный класс приложения
* `project.py` - управление состоянием проекта
* `config.py` - конфигурация приложения
* `logger.py` - настройка логирования

### 2.2 Модуль геометрии (geometry/)
* `__init__.py`
* `brep/` - работа с B-Rep (pythonocc/cadquery)
  * `importer.py` - импорт STEP
  * `converter.py` - конвертация B-Rep ↔ Mesh
* `mesh/` - работа с mesh (trimesh)
  * `importer.py` - импорт STL, OBJ
  * `processor.py` - обработка mesh
* `pointcloud/` - работа с point cloud (Open3D)
  * `importer.py` - импорт PLY
* `geometry_manager.py` - управление геометрией

### 2.3 GUI модуль (gui/)
* `__init__.py`
* `main_window.py` - главное окно приложения
* `viewport/` - 3D viewport
  * `viewport3d.py` - виджет 3D-визуализации (PyVista)
  * `viewport_controller.py` - контроллер viewport
* `widgets/` - кастомные виджеты
* `dialogs/` - диалоговые окна
* `toolbar.py` - панели инструментов
* `menu.py` - меню приложения

### 2.4 Модуль анализа (analysis/)
* `__init__.py`
* `geometry_analyzer.py` - анализ геометрии
* `thickness_analyzer.py` - анализ толщины стенок
* `defect_detector.py` - обнаружение дефектов
* `printability_checker.py` - проверка пригодности для печати

### 2.5 ML модуль (ml/)
* `__init__.py`
* `model_loader.py` - загрузка ML моделей
* `inference.py` - inference
* `defect_classifier.py` - классификация дефектов
* `orientation_predictor.py` - предсказание ориентации

### 2.6 CAM модуль (cam/) - базовый каркас
* `__init__.py`
* `operations.py` - операции обработки
* `toolpath_generator.py` - генерация траекторий

### 2.7 Утилиты (utils/)
* `__init__.py`
* `file_utils.py` - работа с файлами
* `math_utils.py` - математические утилиты
* `constants.py` - константы

## Этап 3: Интеграция библиотек

### 3.1 GUI Framework (PySide6)
* Установка PySide6
* Создание базового Qt приложения
* Настройка главного окна
* Базовая структура меню и тулбара

### 3.2 3D Визуализация (PyVista)
* Установка PyVista и VTK
* Создание базового 3D viewport
* Интеграция в Qt приложение
* Базовые функции навигации

### 3.3 Геометрические библиотеки
* Установка pythonocc/cadquery
* Установка trimesh
* Установка Open3D
* Тестирование импорта основных форматов

## Этап 4: Базовое приложение

### 4.1 Точка входа
* `src/solidflow/__main__.py` - точка входа приложения
* `src/main.py` или `run.py` - альтернативная точка входа

### 4.2 Инициализация приложения
* Создание экземпляра QApplication
* Инициализация главного окна
* Запуск event loop

### 4.3 Базовая функциональность
* Меню File (New, Open, Save, Exit)
* Базовый viewport с тестовой моделью
* Минимальный UI для проверки работы

## Этап 5: Тестирование и качество кода

### 5.1 Настройка тестов
* Структура папки tests/
* Конфигурация pytest (pytest.ini или pyproject.toml)
* Базовые примеры тестов

### 5.2 Инструменты качества кода
* Настройка black (форматирование)
* Настройка flake8 (линтинг)
* Настройка mypy (опционально, проверка типов)
* Pre-commit хуки (опционально)

### 5.3 Базовые тесты
* Тесты для утилит
* Тесты для импорта файлов
* Интеграционные тесты (базовые)

## Этап 6: Документация и сборка

### 6.1 Документация кода
* Настройка docstring стиля
* Примеры документации для основных классов
* Настройка Sphinx (опционально)

### 6.2 Сборка
* Настройка setuptools (setup.py или pyproject.toml)
* Базовая конфигурация PyInstaller (для будущей сборки)
* Скрипты сборки в scripts/

### 6.3 CI/CD базовая настройка
* GitHub Actions workflow для тестов
* GitHub Actions workflow для линтинга
* Конфигурация для будущей автоматической сборки

## Этап 7: Конфигурация и логирование

### 7.1 Система конфигурации
* Файл конфигурации (JSON/YAML)
* Загрузка настроек
* Сохранение пользовательских настроек

### 7.2 Логирование
* Настройка logging
* Уровни логирования
* Файлы логов
* Интеграция в GUI (опционально, для отладки)

## Порядок выполнения

### Фаза 1: Минимальная рабочая версия (MVP структуры)
1. Создать структуру директорий
2. Создать базовые конфигурационные файлы
3. Настроить виртуальное окружение и зависимости
4. Создать минимальную структуру модулей с __init__.py
5. Создать базовое Qt приложение с пустым окном
6. Проверить запуск приложения

### Фаза 2: Базовая функциональность
7. Интегрировать PyVista viewport
8. Создать базовый импорт тестовых файлов (STL)
9. Отобразить модель в viewport
10. Добавить базовое меню (File -> Open, Exit)

### Фаза 3: Инфраструктура
11. Настроить тестирование
12. Настроить линтеры и форматтеры
13. Настроить базовый CI/CD
14. Добавить логирование

## Зависимости для requirements.txt (базовые)

```
# GUI
PySide6>=6.5.0

# 3D Visualization
pyvista>=0.40.0
vtk>=9.2.0

# Geometry
trimesh>=3.20.0
open3d>=0.17.0

# CAD (B-Rep)
pythonocc-core>=7.7.0
cadquery>=2.3.0

# Scientific Computing
numpy>=1.24.0
scipy>=1.10.0

# ML
torch>=2.0.0

# Utilities
pyyaml>=6.0
```

## Зависимости для requirements-dev.txt

```
# Testing
pytest>=7.4.0
pytest-cov>=4.1.0
pytest-qt>=4.2.0

# Code Quality
black>=23.7.0
flake8>=6.1.0
mypy>=1.5.0

# Documentation
sphinx>=7.1.0
sphinx-rtd-theme>=1.3.0

# Building
pyinstaller>=5.13.0
setuptools>=68.0.0
wheel>=0.41.0
```

## Критерии готовности каркаса

Каркас считается готовым, когда:
1. ✅ Проект запускается и показывает пустое окно Qt
2. ✅ Структура директорий создана и документирована
3. ✅ Все основные модули имеют базовую структуру
4. ✅ Зависимости установлены и работают
5. ✅ Базовый 3D viewport интегрирован (показывает тестовую модель)
6. ✅ Меню File -> Open работает (импорт STL файла)
7. ✅ Тесты настроены и запускаются
8. ✅ Линтеры и форматтеры настроены
9. ✅ Базовый CI/CD настроен
10. ✅ Документация по настройке обновлена

