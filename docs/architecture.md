# Архитектура системы

## Общая архитектура

SolidFlow Desktop построен на модульной desktop-архитектуре, что обеспечивает гибкость, расширяемость и поддерживаемость системы.

## Ключевые архитектурные принципы

### Модульность
Система разделена на независимые модули, каждый из которых отвечает за определенную функциональность:
* Модуль импорта/экспорта
* Модуль геометрических операций
* Модуль анализа
* Модуль визуализации
* ML-модуль
* CAM-модуль
* FEM-модуль (опционально)

### Plugin-архитектура
Поддержка plugin-подхода позволяет расширять функциональность без модификации основной кодовой базы. Новые алгоритмы и инструменты могут быть добавлены как плагины.

### Управление состоянием проекта
Централизованная система управления состоянием проекта обеспечивает:
* Сохранение и загрузку проектов
* Отслеживание изменений
* История операций (undo/redo)
* Синхронизацию между различными представлениями данных

## Компоненты системы

### Ядро геометрии
Обеспечивает работу с различными представлениями геометрии:
* B-Rep (boundary representation) через cadquery/pythonocc
* Mesh через trimesh/Open3D
* Point cloud через Open3D

### Синхронизация данных
Критически важный компонент, обеспечивающий синхронизацию между различными представлениями одной и той же геометрии:
* Конвертация B-Rep ↔ Mesh с контролем допусков
* Обновление представлений при изменении данных
* Обеспечение целостности данных

### Модуль визуализации
* Интерактивный 3D-viewport на базе PyVista/VTK
* Оптимизация рендеринга для больших моделей
* Интерактивные инструменты (сечения, измерения, аннотации)

### ML-модуль
* Локальный inference на PyTorch
* Предобработка данных для анализа
* Интеграция с модулем анализа геометрии

### UI-слой
* Qt-приложение (PySide6/PyQt6)
* Разделение бизнес-логики и представления
* Реактивная архитектура для обновления UI

## Инженерные вызовы

### Производительность
* Оптимизация работы с большими моделями
* Асинхронная обработка тяжелых операций
* Кэширование результатов вычислений

### Управление памятью
* Эффективная работа с 3D-данными
* Освобождение неиспользуемых ресурсов
* Оптимизация структур данных

### Интеграция компонентов
* Согласованные интерфейсы между модулями
* Обработка ошибок и исключительных ситуаций
* Логирование и отладка

